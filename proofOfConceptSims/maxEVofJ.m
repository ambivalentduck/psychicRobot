function maxEVofJ

syms L2 S Q0 positive
syms dU real
T0=solve(dU/S-L2/(S^3)-Q0,S);

N=1000;
L2=1;
dU=10;
Q0=3;

S0=real([(6.*L2.^(1./2).*(3.^(1./2).*(27.*L2.*Q0.^2 - 4.*dU.^3).^(1./2) - 9.*L2.^(1./2).*Q0).^(1./3))./(2.^(2./3).*3.^(1./3).*(3.^(1./2).*(27.*L2.*Q0.^2 - 4.*dU.^3).^(1./2) - 9.*L2.^(1./2).*Q0).^(2./3) + 2.*2.^(1./3).*3.^(2./3).*dU), -(6.*2.^(2./3).*3.^(1./3).*L2.^(1./2).*(3.^(1./2).*(27.*L2.*Q0.^2 - 4.*dU.^3).^(1./2) - 9.*L2.^(1./2).*Q0).^(1./3))./(6.*dU + 3.^(1./2).*dU.*(-6.*1i) + 2.^(1./3).*3.^(2./3).*(3.^(1./2).*(27.*L2.*Q0.^2 - 4.*dU.^3).^(1./2) - 9.*L2.^(1./2).*Q0).^(2./3) + 2.^(1./3).*3.^(1./6).*(3.^(1./2).*(27.*L2.*Q0.^2 - 4.*dU.^3).^(1./2) - 9.*L2.^(1./2).*Q0).^(2./3).*(3.*1i)), -(6.*2.^(2./3).*3.^(1./3).*L2.^(1./2).*(3.^(1./2).*(27.*L2.*Q0.^2 - 4.*dU.^3).^(1./2) - 9.*L2.^(1./2).*Q0).^(1./3))./(6.*dU + 3.^(1./2).*dU.*(6.*i) + 2.^(1./3).*3.^(2./3).*(3.^(1./2).*(27.*L2.*Q0.^2 - 4.*dU.^3).^(1./2) - 9.*L2.^(1./2).*Q0).^(2./3) + 2.^(1./3).*3.^(1./6).*(3.^(1./2).*(27.*L2.*Q0.^2 - 4.*dU.^3).^(1./2) - 9.*L2.^(1./2).*Q0).^(2./3).*(-3.*1i))]);
S0=S0(2)

figure(1)
clf
hold on

Tcrit=sqrt(3*L2/dU);
T=linspace(sqrt(L2/dU),10*Tcrit);
%0=deltaU-L2.*T^-2

plot(T.^-2,EJdot(dU,L2,Q0,T),'b-')
plot(dU/(3*L2),EJdot(dU,L2,Q0,Tcrit),'rx')
plot(S0.^-2,EJdot(dU,L2,Q0,S0),'c.')

function x=EJdot(dU,L2,Q0,T)

x=dU./T-L2.*T.^-3-Q0;